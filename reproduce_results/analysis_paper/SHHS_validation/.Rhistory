coef
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
coef
coef
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
coef
coef$coef
coef[1:(nrow(coef)/2),]
coef[1:(nrow(coef)/2),]$X
gsub('_1:2','',coef[1:(nrow(coef)/2),]$X)
rownames(coef)
coef <- read.csv(file.path(mgh_result_folder, sprintf('coef_%s_%s.csv', outcome, model_type)))
coef <- coef[1:(nrow(coef)/2),]
rownames(coef) <- gsub('_1:2','',coef$X)
coef
coef[Xnames_all,]
coef$coef[Xnames_all,]
coef[Xnames_all,]$coef
Xnames_all
rownames(coef)
Xnames
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
coef_names
Xnames_all
intersect(Xnames_all, coef_names)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
coef
Xnames
coef[Xnames,]
coef[Xnames,]$coef
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
age_mean
mean(df$Age)
X_before_impute
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
mean(df$Age)
min(df$Age)
sort(df$Age)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
Xmean$Age
Xmean
Xmean['Age']
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
dfX_MGH[,Xnames]%*%coef
as.matrix(dfX_MGH[,Xnames])%*%coef
drop(as.matrix(dfX_MGH[,Xnames])%*%coef)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
df_bt$zp_factor
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
cox_curve_tes_bt$time
dim(cox_curve_tes_bt$val)
plot(cox_curve_tes_bt$time, cox_curve_tes_bt[,1,1,2])
plot(cox_curve_tes_bt$time, cox_curve_tes_bt$val[,1,1,2])
result_path
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
setdiff(rownames(coef),Xnames_all)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
coef
Xnames
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
coef
Xnames
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
df_bt$event
dim(AJ_survprob)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_validate_SHHS.R")
sprintf('%saaa','kk')
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_validate_SHHS.R")
Xmean
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_validate_SHHS.R")
-Xmean['Sex']
dfX_MGH$Sex
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_validate_SHHS.R")
actual.sex
df_bt$Sex
actual.sex
dim(AJ_survprob)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_validate_SHHS.R")
dim(AJ_survprob)
AJ_survprob
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_validate_SHHS.R")
loadRDS
readRDS
model<-readRDS(file.path(mgh_result-folder,sprintf(('model_%s_%s.rda', outcome, model_type)))
model<-readRDS(file.path(mgh_result_folder,sprintf(('model_%s_%s.rda', outcome, model_type)))
sprintf(('model_%s_%s.rda', outcome, model_type)
model<-readRDS(file.path(mgh_result_folder,sprintf('model_%s_%s.rda', outcome, model_type)))
model
aa<-survfit(model,df[1:2,])
aa<-survfit(model[[1]],df[1:2,])
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
MGH_match_mask
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
dim(dftr)
dim(dftr)
zptr2
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
actual.sex.tr
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
dftr
dftr$time
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
names(dftrX)
names(dftry)
stopifnot(all(dftrX$MRN==dftry$MRN))
dftry <- subset(dftry, select=-c(PatientID, MRN, DateOfVisit))
dftr <- cbind(dftrX, dftry)
names(dftr)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
plot(cox_res)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
cox_res
plot(cox_res)
plot(AJ_res)
plot(AJ_fit)
dim(dftr)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
plot(cox_res)
plot(AJ_fit)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
plot(cox_res)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
plot(cox_res)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
plot(AJ_fit)
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
plot(cox_res)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
actual.sex
actual.sex.tr
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
plot(cox_res)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
plot(cox_res)
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step4_fit_model_for_future_competing_risk.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step4_fit_model_for_future_competing_risk.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step4_fit_model_for_future_competing_risk.R")
xnames
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step4_fit_model_for_future_competing_risk.R")
xnames
length(xnames)
length(xnames_c)
list(1)
list(1,2)
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step4_fit_model_for_future_competing_risk.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step4_fit_model_for_future_competing_risk.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
Xnames_all
length(Xnames_all)
length(Xmean)
Xmean
Xstd
dim(df)
df
names(df)
Xnames_all
length(Xmean)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(mat$Xtr)
apply(mat$Xtr, 2, mean, na.rm=TRUE)
apply(mat$Xtr, 2, std, na.rm=TRUE)
apply(mat$Xtr, 2, sd, na.rm=TRUE)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
apply(mat$Xtr, 2, mean, na.rm=TRUE)
apply(X_before_impute, 2, mean, na.rm=TRUE)
apply(X_before_impute, 2, sd, na.rm=TRUE)
model <- readRDS(file.path(mgh_result_folder, sprintf('model_%s_%s.rda', outcome, model_type)))
model
typeof(model)
length(model)
model[[1]]$coefficients
length(model[[1]]$coefficients)
survfit(model[[1]], df[1:2,])
aa<-survfit(model[[1]], df[1:2,])
plot(aa)
dim(aa$pstate)
kk<-summary(aa)
dim(kk$pstate)
plot(kk)
aa<-survfit(model[[1]], df[1:20,])
size(df)
dim(df)
aa<-survfit(model[[1]], df[1,])
aa<-survfit(model[[1]], df[2,])
length(Xnames_all)
1//2
str_replace
install.packages('stringr')
str_replace
library('stringr')
str_replace
fruits <- c("one apple", "two pears", "three bananas")
str_replace(fruits, "[aeiou]", "-")
str_replace_all(fruits, "[aeiou]", "-")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
coef
coef
coef
df[,names(coef)]
drop(as.matrix(df[,names(coef)])%*%coef)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
sum(zp2==1)
sum(zp2==2)
sum(zp2==3)
df$Sex
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
names(df)
names(df2)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(AJ_res$pstate)
plot(AJ_res)
plot(AJ_fit)
AJ_res$upper
sum((df2$zp_factor==1)&(df2$actual.sex==0))
sum((df2$zp_factor==1)&(df2$actual.sex==1))
sum((df2$zp_factor==2)&(df2$actual.sex==0))
sum((df2$zp_factor==2)&(df2$actual.sex==1))
sum((df2$zp_factor==3)&(df2$actual.sex==0))
sum((df2$zp_factor==3)&(df2$actual.sex==1))
(df2$zp_factor==1)&(df2$actual.sex==1)
find(df2$zp_factor==1)&(df2$actual.sex==1))
find((df2$zp_factor==1)&(df2$actual.sex==1))
which((df2$zp_factor==1)&(df2$actual.sex==1))
?sample
ids<-sample( which((df2$zp_factor==1)&(df2$actual.sex==1)), 30,replace=False)
ids<-sample( which((df2$zp_factor==1)&(df2$actual.sex==1)), 30,replace=F)
F
length(ids)
kk<-survfit(model, df[ids,])
dim(kk)
aa<-summary(kk)
dim(aa$pstate)
?mean
dim(apply(aa$pstate,1,mean))
dim(apply(aa$pstate,c(1,3),mean))
aa$pstate[1,:,1]
aa$pstate[1,,1]
mean(aa$pstate[1,,1])
mean(aa$pstate[100,,1])
apply(aa$pstate,c(1,3),mean)[1,1]
apply(aa$pstate,c(1,3),mean)[100,1]
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
ids <- (df2$zp_factor[1:30]==level)&(df2$actual.sex[1:30]==sex)
ids
cox_survtime <- res2$time
cox_survtime
apply(res2$pstate[ids,],c(1,3),mean)
apply(res2$pstate[ids,,],c(1,3),mean)
cox_survprob <- apply(res2$pstate[ids,,],c(1,3),mean)
cox_survstate <- res2$states
res2$states
cox_survprob
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
length(cox_curves)
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
Ncurve
K
idx
fn <- stepfun(idx, c(pre_fill_val, val[,j]))
dim(res2$pstate[ids,,])
?apply
?array
cox_survprob <- apply(res2$pstate[ids,,],c(1,3),mean)
dim(cox_survprob)
dim(array(cox_survprob,dim=c(87,1,3)))
dim(cox_survprob)[1]
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
aa<- harmonize.curves2(cox_curves)
dim(cox_curves[[1]]$val)
dim(cox_curves[[2]]$val)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_fit_model_for_future_competing_risk.R")
length(cox_curve_tes)
dim(cox_curve_tes[[1]]$val)
dim(cox_curve_tes[[2]]$val)
dim(cox_curve_tes[[3]]$val)
dim(cox_curve_tes[[4]]$val)
dim(cox_curve_tes[[1]]$time)
length(cox_curve_tes[[1]]$time)
length(cox_curve_tes[[2]]$time)
length(cox_curve_tes[[3]]$time)
length(cox_curve_tes[[4]]$time)
dim(cox_curve_tes$val)
dim(cox_curve_tes$val)
length(cox_curve_tes$time)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_curves[[1]]$val)
dim(cox_curves[[2]]$val)
aa<-harmonize.curves2(cox_curves)
cox_curves[[1]]$time
cox_curves[[2]]$time
?stepfun
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
idx
c(pre_fill_val, val[,j])
length(idx)
length(c(pre_fill_val, val[,j]))
dim(val)
T
?findInterval
length(times[[i]])
f
f
Q
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
T
dimension
K
dim(all_vals)
idx
length(idx)
dim(val)
length(times[[i]])
length(all_times)
length(times)
length(times[[1]])
length(times[[2]])
length(times[[3]])
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
length(cox_curves[[1]]$time)
dim(cox_curves[[1]]$val)
length(res2$time)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(res2$pstate)
dim(res2$pstate[,ids,])
dim(apply(res2$pstate[,ids,],c(1,3),mean))
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_survprobs[[1]])
dim(cox_survprobs[[2]])
dim(cox_survprobs[[3]])
cox_survprobs <- simplify2array(cox_survprobs)
dim(cox_survprobs)
dim(AJ_survprob)
cox_survprobs <- aperm(cox_survprobs, c(1,2,4,3))
dim(AJ_survprob)
dim(cox_survprobs)
cox_survprobs <- cox_survprobs[,1,,]
dim(cox_survprobs)
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_fit_model_for_future_competing_risk.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_fit_model_for_future_competing_risk.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_fit_model_for_future_competing_risk.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_fit_model_for_future_competing_risk.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_fit_model_for_future_competing_risk.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(df[ids,])
length(res2$time)
dim(cox_survprob)
length(res2$time)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
fprintf('level = %d, sex = %d', level, sex)
printf('level = %d, sex = %d', level, sex)
print(sprintf('level = %d, sex = %d', level, sex))
levels
sex
sexs
length(cox_curves[[1]]$time)
dim(cox_curves[[1]]$val)
aa<- harmonize.curves2(cox_curves)
dim(aa$val)
cox_curves <- harmonize.curves2(cox_curves)
cox_curves$val <- cox_curves$val[,,1,]
dim(cox_curves$val)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(res2$surv)
dim(cox_survprob)
length(cox_survprob)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_survprob)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_curves[[1]]$val)
dim(cox_curves$val)
cox_curves$val <- cox_curves$val[,,1]
dim(cox_curves$val)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
length(res2$time)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
sum(ids)
dim(cox_curves[[1]])
dim(cox_curves[[2]])
cox_curves <- simplify2array(cox_curves)
dim(cox_curves)
cox_curves <- cox_curves[,1,]
dim(cox_curves)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(res2$pstate)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_survprob)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_curves)
cox_curves <- aperm(cox_curves, c(1,2,4,3))
cox_curves <- cox_curves[,1,,]
dim(cox_curves)
sample(1:5, replace=TRUE)
sample(1:5, replace=TRUE)
sample(1:5, replace=TRUE)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(res2$pstate)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_survprob)
dim(cox_survprob)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
sum(ids)
dim(res2$pstate[,ids,])
dim(res2$pstate[,c(ids),])
dim(res2$pstate[,c(ids),,drop = F])
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(res2$pstate[,ids,,drop=F])
dim(apply(res2$pstate[,ids,,drop=F],c(1,3),mean))
dim(apply(res2$pstate[,ids,,drop=F],c(1,3),mean,drop=F))
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_curves)
dim(cox_curves)
dim(res2$pstate)
dim(cox_curves_bt[[1]])
dim(cox_curves_bt[[2]])
cox_curves_bt[[1]]
cox_curves_bt[[2]]
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_curves_bt[[1]])
dim(cox_curves_bt[[2]])
dim(cox_curves_bt[[3]])
dim(cox_curves_bt[[4]])
dim(cox_curves_bt[[5]])
cox_curves_bt <- simplify2array(cox_curves_bt[[1:4]])
cox_curves_bt <- simplify2array(cox_curves_bt[1:4])
dim(cox_curves_bt)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_fit_model_for_future_competing_risk.R")
dim(cox_curve_tes_bt$val)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step2_fit_model_for_future_competing_risk.R")
dim(cox_curve_tes_bt$val)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_curves_bt)
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
cox_curves_bt <- simplify2array(cox_curves_bt[1:4])
dim(cox_curves_bt)
cox_curves_bt <- aperm(cox_curves_bt, c(1,4,2,3))
dim(cox_curves_bt)
dim(AJ_survprob)
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_curves_bt)
cox_curves_bt <- aperm(cox_curves_bt, c(1,3,2))
dim(cox_curves_bt)
dim(AJ_survprob)
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
Xmean
Xmean[covariate_names]
Xstd[covariate_names]
df$Age
df$Age
z_boundaries
df2
df2$Sex
df_bt$Sex
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
df2$actual.sex
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
debugSource("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
dim(cox_curves)
dim(cox_curves)
source("/data/Dropbox (Partners HealthCare)/SleepBasedOutcomePrediction (1)/code-haoqi/SHHS_validation/step3_validate_SHHS2.R")
which.min(abs(AJ_survtime-10))
length(AJ_survtime)
AJ_survtime[855]
dim(cox_curves_bt)
cox_curves_bt[855,1,1]
AJ_survprob[855,1,1]
dim(AJ_survprob)
AJ_survprob[855,c(1,2,3)]
which.min(abs(cox_survtime-10))
cox_curves_bt[345,1,c(1,2,3)]
AJ_survprob[855,1]/AJ_survprob[855,2]
AJ_survprob[855,3]/AJ_survprob[855,2]
cox_curves_bt[345,1,1]/cox_curves_bt[345,1,2]
cox_curves_bt[345,1,3]/cox_curves_bt[345,1,2]
AJ_survprob[855,4]/AJ_survprob[855,5]
AJ_survprob[855,6]/AJ_survprob[855,5]
AJ_survprob[855,4]/AJ_survprob[855,5]
cox_curves_bt[345,1,4]/cox_curves_bt[345,1,5]
cox_curves_bt[345,1,6]/cox_curves_bt[345,1,5]
